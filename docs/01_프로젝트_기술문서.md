# BAIKAL Groupware AI — 프로젝트 기술문서

> **문서 버전:** 1.0  
> **최종 수정일:** 2026-02-27  
> **작성:** BAIKAL AI 개발팀

---

## 1. 프로젝트 개요

**BAIKAL Groupware AI**는 AI Agent를 중심에 둔 차세대 그룹웨어 솔루션입니다.  
기존 그룹웨어처럼 메뉴를 탐색하는 대신, **자연어 대화 한 줄**로 결재 문서 작성, 업무 등록, 일정 관리, 공지사항 작성 등 모든 그룹웨어 기능을 실행할 수 있습니다.

- **프로젝트명:** BAIKAL Groupware AI (MVP)
- **아키텍처:** 모노레포 (frontend + backend)
- **라이선스:** Proprietary

---

## 2. 시스템 아키텍처

```
┌──────────────────────────────────────────────────────────┐
│                      Client (Browser)                     │
│  ┌─────────────────────────────────────────────────────┐ │
│  │  React 18 + Vite + Tailwind CSS + Zustand          │ │
│  │  ┌─────────┐ ┌───────────┐ ┌──────────────┐       │ │
│  │  │Sidebar  │ │ AI Chat   │ │ Result Panel │       │ │
│  │  │ Menu    │ │ Panel     │ │ (상세/목록)  │       │ │
│  │  └─────────┘ └─────┬─────┘ └──────────────┘       │ │
│  └────────────────────┼────────────────────────────────┘ │
└───────────────────────┼──────────────────────────────────┘
                        │ HTTPS/REST (Axios + JWT)
┌───────────────────────┼──────────────────────────────────┐
│                   Backend (FastAPI)                        │
│  ┌────────────────────┼────────────────────────────────┐ │
│  │ API Layer          ▼                                │ │
│  │ ┌──────┐ ┌──────────────┐ ┌────────────────────┐   │ │
│  │ │Auth  │ │Approvals/    │ │ AI Chat Endpoint   │   │ │
│  │ │Router│ │Tasks/Schedule│ │ POST /api/chat     │   │ │
│  │ │      │ │/Notices      │ └────────┬───────────┘   │ │
│  │ └──────┘ └──────────────┘          │               │ │
│  │                                     ▼               │ │
│  │                          ┌──────────────────────┐   │ │
│  │                          │   AI Agent Engine     │   │ │
│  │                          │ (OpenAI / Ollama)     │   │ │
│  │                          │ + Function Calling    │   │ │
│  │                          │ + Tool Executor       │   │ │
│  │                          └──────────┬───────────┘   │ │
│  │                                     │               │ │
│  │  ┌──────────────────────────────────┼─────────────┐ │ │
│  │  │          SQLAlchemy Async ORM    ▼             │ │ │
│  │  │  ┌──────────────────────────────────────────┐  │ │ │
│  │  │  │  SQLite (로컬) / PostgreSQL 16 (Docker)  │  │ │ │
│  │  │  └──────────────────────────────────────────┘  │ │ │
│  │  └────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────┘
                        │
          ┌─────────────┼─────────────┐
          ▼                           ▼
  ┌───────────────┐         ┌──────────────────┐
  │  OpenAI API   │         │  Ollama (Local)   │
  │  GPT-4o       │         │  Llama 3.1:8B     │
  └───────────────┘         └──────────────────┘
```

---

## 3. 기술 스택

### 3.1 Backend

| 기술 | 버전 | 용도 |
|------|------|------|
| Python | 3.11+ | 런타임 |
| FastAPI | 0.115.6 | REST API 프레임워크 |
| Uvicorn | 0.34.0 | ASGI 서버 |
| SQLAlchemy | 2.0.36 | ORM (비동기) |
| aiosqlite | 0.20.0 | SQLite 비동기 드라이버 (로컬) |
| asyncpg | - | PostgreSQL 비동기 드라이버 (Docker) |
| Pydantic | 2.10.3 | 스키마 검증 |
| python-jose | 3.3.0 | JWT 토큰 |
| passlib | 1.7.4 | bcrypt 패스워드 해싱 |
| OpenAI SDK | 1.58.1 | GPT-4o Function Calling |
| httpx | 0.28.1 | Ollama HTTP 클라이언트 |

### 3.2 Frontend

| 기술 | 버전 | 용도 |
|------|------|------|
| React | 18.3.1 | UI 프레임워크 |
| Vite | 6.0.3 | 빌드 도구 |
| Tailwind CSS | 3.4.16 | 유틸리티 CSS |
| Zustand | 5.0.2 | 상태 관리 |
| React Router | 6.28.0 | 라우팅 |
| Axios | 1.7.9 | HTTP 클라이언트 |
| lucide-react | 0.468.0 | 아이콘 |
| react-markdown | 9.0.1 | 마크다운 렌더링 |
| date-fns | 4.1.0 | 날짜 포매팅 |

### 3.3 인프라

| 기술 | 용도 |
|------|------|
| Docker Compose 3.9 | 컨테이너 오케스트레이션 |
| PostgreSQL 16 | 프로덕션 DB (Docker) |
| SQLite | 로컬 개발 DB |
| Nginx | 프론트엔드 서빙 (Docker) |

---

## 4. 디렉토리 구조

```
baikal-groupware-ai/
├── docker-compose.yml          # Docker 배포 구성
├── .env.example                # 환경변수 템플릿
├── README.md                   # 프로젝트 소개
├── docs/                       # 프로젝트 문서
│
├── backend/
│   ├── Dockerfile
│   ├── requirements.txt
│   └── app/
│       ├── main.py             # FastAPI 진입점, CORS, 라우터 등록
│       ├── core/
│       │   ├── config.py       # pydantic-settings 기반 설정
│       │   └── security.py     # JWT 생성/검증, 비밀번호 해싱
│       ├── db/
│       │   ├── database.py     # 비동기 엔진/세션 팩토리
│       │   ├── models.py       # SQLAlchemy 모델 8개
│       │   └── init_db.py      # 테이블 생성 + 시드 데이터
│       ├── schemas/
│       │   └── schemas.py      # Pydantic 요청/응답 스키마
│       ├── api/
│       │   ├── deps.py         # 인증 의존성 (get_current_user)
│       │   ├── auth.py         # 인증 라우터
│       │   ├── approvals.py    # 전자결재 라우터
│       │   ├── tasks.py        # 업무 라우터
│       │   ├── schedules.py    # 일정 라우터
│       │   ├── notices.py      # 공지사항 라우터
│       │   └── chat.py         # AI 채팅 라우터
│       └── agent/
│           ├── tools.py        # 9개 Function Calling 도구 정의
│           ├── executor.py     # ToolExecutor (DB 연동 실행)
│           └── engine.py       # AI Agent 엔진 (OpenAI/Ollama)
│
└── frontend/
    ├── Dockerfile
    ├── package.json
    ├── vite.config.js
    ├── tailwind.config.js
    ├── index.html
    └── src/
        ├── main.jsx            # React 진입점
        ├── App.jsx             # 라우팅 + ProtectedRoute
        ├── index.css           # Tailwind + 커스텀 컴포넌트 CSS
        ├── lib/api.js          # Axios 인스턴스 + JWT 인터셉터
        ├── stores/store.js     # Zustand 스토어
        ├── layouts/MainLayout.jsx
        ├── components/
        │   ├── ChatPanel.jsx
        │   └── ResultPanel.jsx
        └── pages/
            ├── LoginPage.jsx
            ├── DashboardPage.jsx
            ├── ApprovalsPage.jsx
            ├── TasksPage.jsx
            ├── SchedulesPage.jsx
            └── NoticesPage.jsx
```

---

## 5. 데이터베이스 스키마

### 5.1 ER 다이어그램 (논리)

```
 users ──────────┬──> approvals ──> approval_lines ──> approval_logs
                 ├──> tasks
                 ├──> schedules
                 ├──> notices
                 └──> chat_messages
```

### 5.2 테이블 상세

#### `users`
| 컬럼 | 타입 | 제약 | 설명 |
|------|------|------|------|
| id | UUID | PK | 자동 생성 |
| email | VARCHAR(255) | UNIQUE, NOT NULL | 로그인 이메일 |
| hashed_password | VARCHAR(255) | NOT NULL | bcrypt 해시 |
| name | VARCHAR(100) | NOT NULL | 사용자 이름 |
| department | VARCHAR(100) | DEFAULT '' | 부서 |
| position | VARCHAR(100) | DEFAULT '' | 직책 |
| role | VARCHAR(20) | DEFAULT 'user' | admin / user |
| is_active | BOOLEAN | DEFAULT TRUE | 활성 상태 |
| created_at | DATETIME | UTC | 생성일시 |
| updated_at | DATETIME | UTC, auto-update | 수정일시 |

#### `approvals`
| 컬럼 | 타입 | 제약 | 설명 |
|------|------|------|------|
| id | UUID | PK | - |
| title | VARCHAR(300) | NOT NULL | 제목 |
| content | TEXT | - | 내용 |
| category | VARCHAR(100) | DEFAULT 'general' | general/travel/leave/purchase |
| status | VARCHAR(20) | DEFAULT 'draft' | draft/pending/approved/rejected |
| author_id | UUID | FK→users | 작성자 |
| created_at / updated_at | DATETIME | - | - |

#### `approval_lines`
| 컬럼 | 타입 | 제약 | 설명 |
|------|------|------|------|
| id | UUID | PK | - |
| approval_id | UUID | FK→approvals | 결재 문서 |
| approver_id | UUID | FK→users | 결재자 |
| order | INTEGER | NOT NULL | 결재 순서 |
| action | VARCHAR(20) | DEFAULT 'pending' | pending/approved/rejected |
| comment | TEXT | nullable | 코멘트 |
| acted_at | DATETIME | nullable | 처리 일시 |

#### `tasks`
| 컬럼 | 타입 | 제약 | 설명 |
|------|------|------|------|
| id | UUID | PK | - |
| title | VARCHAR(300) | NOT NULL | 제목 |
| description | TEXT | - | 설명 |
| status | VARCHAR(20) | DEFAULT 'todo' | todo/in_progress/done |
| priority | VARCHAR(20) | DEFAULT 'medium' | low/medium/high/urgent |
| due_date | DATETIME | nullable | 마감일 |
| creator_id | UUID | FK→users | 생성자 |
| assignee_id | UUID | FK→users, nullable | 담당자 |

#### `schedules`
| 컬럼 | 타입 | 제약 | 설명 |
|------|------|------|------|
| id | UUID | PK | - |
| title | VARCHAR(300) | NOT NULL | 제목 |
| description | TEXT | - | 설명 |
| start_time | DATETIME | NOT NULL | 시작 |
| end_time | DATETIME | NOT NULL | 종료 |
| location | VARCHAR(255) | - | 장소 |
| creator_id | UUID | FK→users | 생성자 |

#### `notices`
| 컬럼 | 타입 | 제약 | 설명 |
|------|------|------|------|
| id | UUID | PK | - |
| title | VARCHAR(300) | NOT NULL | 제목 |
| content | TEXT | - | 내용 |
| is_pinned | BOOLEAN | DEFAULT FALSE | 상단 고정 |
| author_id | UUID | FK→users | 작성자 |

#### `chat_messages`
| 컬럼 | 타입 | 제약 | 설명 |
|------|------|------|------|
| id | UUID | PK | - |
| user_id | UUID | FK→users | 사용자 |
| role | VARCHAR(20) | - | user / assistant |
| content | TEXT | - | 대화 내용 |
| tool_calls | TEXT | nullable | JSON 형태 도구 호출 결과 |
| created_at | DATETIME | - | - |

---

## 6. API 엔드포인트 명세

모든 엔드포인트는 `/api` 프리픽스를 사용합니다.

### 6.1 인증 (Authentication)

| 메서드 | 경로 | 인증 | 설명 |
|--------|------|------|------|
| POST | `/api/auth/login` | ✗ | 로그인 → JWT 토큰 반환 |
| POST | `/api/auth/register` | ✗ | 회원가입 |
| GET | `/api/auth/me` | ✓ | 내 프로필 조회 |
| GET | `/api/auth/users` | ✓ | 사용자 목록 |

**로그인 Request:**
```json
{
  "email": "admin@baikal.ai",
  "password": "admin1234"
}
```

**로그인 Response:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer",
  "user": {
    "id": "uuid",
    "name": "관리자",
    "email": "admin@baikal.ai",
    "role": "admin",
    "department": "경영지원",
    "position": "대표"
  }
}
```

### 6.2 전자결재

| 메서드 | 경로 | 인증 | 설명 |
|--------|------|------|------|
| POST | `/api/approvals` | ✓ | 결재 문서 생성 |
| GET | `/api/approvals` | ✓ | 전체 목록 (`?status=pending` 필터 가능) |
| GET | `/api/approvals/my` | ✓ | 내가 작성한 결재 |
| GET | `/api/approvals/pending` | ✓ | 내가 처리할 결재 |
| GET | `/api/approvals/{id}` | ✓ | 상세 조회 |
| POST | `/api/approvals/{id}/submit` | ✓ | 상신 (draft → pending) |
| POST | `/api/approvals/{id}/action` | ✓ | 승인/반려 |

### 6.3 업무

| 메서드 | 경로 | 인증 | 설명 |
|--------|------|------|------|
| POST | `/api/tasks` | ✓ | 업무 생성 |
| GET | `/api/tasks` | ✓ | 전체 목록 |
| GET | `/api/tasks/my` | ✓ | 내 업무 |
| GET | `/api/tasks/{id}` | ✓ | 상세 조회 |
| PATCH | `/api/tasks/{id}` | ✓ | 업무 수정 |

### 6.4 일정

| 메서드 | 경로 | 인증 | 설명 |
|--------|------|------|------|
| POST | `/api/schedules` | ✓ | 일정 생성 |
| GET | `/api/schedules` | ✓ | 전체 목록 |
| GET | `/api/schedules/my` | ✓ | 내 일정 |
| GET | `/api/schedules/{id}` | ✓ | 상세 조회 |

### 6.5 공지사항

| 메서드 | 경로 | 인증 | 설명 |
|--------|------|------|------|
| POST | `/api/notices` | ✓ | 공지 생성 |
| GET | `/api/notices` | ✓ | 전체 목록 (고정 우선) |
| GET | `/api/notices/{id}` | ✓ | 상세 조회 |

### 6.6 AI 채팅

| 메서드 | 경로 | 인증 | 설명 |
|--------|------|------|------|
| POST | `/api/chat` | ✓ | AI Agent에 메시지 전송 |

**Request:**
```json
{
  "message": "김철수에게 보고서 작성 업무 등록해줘"
}
```

**Response:**
```json
{
  "reply": "김철수님에게 '보고서 작성' 업무를 등록했습니다.",
  "tool_results": [
    {
      "type": "task",
      "data": {
        "message": "업무가 생성되었습니다.",
        "title": "보고서 작성",
        "assignee": "김철수",
        "priority": "medium",
        "status": "todo"
      }
    }
  ]
}
```

### 6.7 헬스체크

| 메서드 | 경로 | 인증 | 설명 |
|--------|------|------|------|
| GET | `/api/health` | ✗ | `{"status":"ok"}` |

---

## 7. AI Agent 시스템

### 7.1 AI 도구 (Function Calling)

| 도구명 | 설명 | 필수 파라미터 | 선택 파라미터 |
|--------|------|---------------|---------------|
| `create_approval` | 전자결재 문서 생성 | title, content | category, approver_names[] |
| `create_task` | 업무 생성 및 담당자 할당 | title | description, assignee_name, priority, due_date |
| `create_schedule` | 일정 등록 | title, start_time, end_time | description, location |
| `create_notice` | 공지사항 작성 | title, content | is_pinned |
| `search_users` | 사용자 검색 | name | - |
| `list_my_approvals` | 내가 작성한 결재 조회 | - | - |
| `list_my_tasks` | 내 업무 조회 | - | - |
| `list_my_schedules` | 내 일정 조회 | - | - |
| `list_notices` | 공지사항 조회 | - | - |

### 7.2 처리 흐름

```
사용자 메시지
    ↓
시스템 프롬프트 + 대화 히스토리 (최근 20건) 구성
    ↓
LLM 호출 (OpenAI GPT-4o 또는 Ollama)
    ↓ function_call 감지?
    ├── Yes → ToolExecutor가 DB 작업 수행 → 결과를 LLM에 재전달
    │                                        ↓
    │                            최종 자연어 응답 생성
    └── No → 직접 자연어 응답 반환
    ↓
프론트엔드에 reply + tool_results 전송
```

### 7.3 LLM 지원

| 프로바이더 | 모델 | 설정 |
|-----------|------|------|
| OpenAI | GPT-4o (기본) | `LLM_PROVIDER=openai`, `OPENAI_API_KEY` 필요 |
| Ollama | Llama 3.1:8B | `LLM_PROVIDER=ollama`, 로컬 Ollama 서버 필요 |

---

## 8. 인증 시스템

| 항목 | 상세 |
|------|------|
| 방식 | JWT Bearer Token (HS256) |
| 토큰 만료 | 480분 (8시간) |
| 비밀번호 해싱 | bcrypt (passlib) |
| 저장 | localStorage (프론트엔드) |
| 전송 | `Authorization: Bearer <token>` 헤더 |
| 401 처리 | 자동 로그아웃 + `/login` 리다이렉트 |
| 권한 체계 | admin (관리자) / user (일반 사용자) |

---

## 9. 환경 변수

| 변수명 | 기본값 | 설명 |
|--------|--------|------|
| `LLM_PROVIDER` | `openai` | LLM 제공자 (openai / ollama) |
| `OPENAI_API_KEY` | (없음) | OpenAI API 키 |
| `OPENAI_MODEL` | `gpt-4o` | OpenAI 모델명 |
| `OLLAMA_BASE_URL` | `http://localhost:11434` | Ollama 서버 URL |
| `OLLAMA_MODEL` | `llama3.1:8b` | Ollama 모델명 |
| `DATABASE_URL` | `sqlite+aiosqlite:///./baikal_groupware.db` | DB 연결 문자열 |
| `SECRET_KEY` | `baikal-secret-key-change-in-production` | JWT 서명 키 |
| `BACKEND_URL` | `http://localhost:8000` | 백엔드 URL |

---

## 10. 배포 방식

### 10.1 로컬 개발 (SQLite)

```bash
# Backend
cd backend
pip install -r requirements.txt
uvicorn app.main:app --reload --port 8000

# Frontend
cd frontend
npm install
npm run dev -- --port 3000
```

### 10.2 Docker 배포 (PostgreSQL)

```bash
cp .env.example .env
# .env 파일에서 OPENAI_API_KEY, SECRET_KEY 설정

docker-compose up -d --build
```

**서비스 구성:**
- `postgres`: PostgreSQL 16 (포트 5432)
- `backend`: FastAPI (포트 8000)
- `frontend`: Nginx + React 정적 파일 (포트 80)

---

*© 2026 BAIKAL AI. All rights reserved.*
